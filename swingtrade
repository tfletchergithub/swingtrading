import requests
from bs4 import BeautifulSoup
import pandas as pd
from openpyxl import Workbook

def get_stock_data(ticker):
    base_url = f'https://finviz.com/quote.ashx?t={ticker}'
    response = requests.get(base_url)
    soup = BeautifulSoup(response.text, 'html.parser')

    # Extract relevant data from the website
    # You may need to inspect the website structure to find the correct elements
    # The example below is just a placeholder, and you may need to adjust it based on the website's structure.
    data = {
        'Stock Symbol/Ticker': ticker,
        'Quarter 1 Earnings Report Release Date': '...',
        'Quarter 1 Estimated EPS score': '...',
        'Quarter 1 Actual EPS score': '...',
        # ... Add more fields as needed
    }

    return data

def fetch_stock_data(tickers):
    all_stock_data = []

    for ticker in tickers:
        stock_data = get_stock_data(ticker)
        all_stock_data.append(stock_data)

    return all_stock_data

def save_to_excel(data, output_file):
    df = pd.DataFrame(data)
    df.to_excel(output_file, index=False)

def main():
    tickers = input("Enter stock tickers separated by a space: ").upper().split()
    
    stock_data = fetch_stock_data(tickers)

    # Save the data to an Excel file
    output_file = 'stock_data.xlsx'
    save_to_excel(stock_data, output_file)
    
    print(f"Stock data has been saved to {output_file}")

if __name__ == "__main__":
    main()
